!function(u){"use strict";u.fn.serializeArrayAll=function(){var i=/\r?\n/g;return this.map(function(){return this.elements?jQuery.makeArray(this.elements):this}).map(function(t,e){var a=jQuery(this).val();return null==a||("checkbox"==this.type&&0==this.checked?{name:this.name,value:this.checked?this.value:""}:jQuery.isArray(a)?jQuery.map(a,function(t,a){return{name:e.name,value:t.replace(i,"\r\n")}}):{name:e.name,value:a.replace(i,"\r\n")})}).get()};var n=u("body");function r(t,a){a.removeClass("loading"),u.magnificPopup.open({mainClass:"mfp-fade popup-product-quick-view",items:{src:t.html(),type:"inline"},callbacks:{open:function(){var t=this.content.find(".product-container"),a=window.innerHeight,a=parseInt(a-60),a=Math.min(a,760);t.outerHeight(a),t.perfectScrollbar({suppressScrollX:!0});var a=this.content.find(".woo-single-gallery"),t=a.children(".edumall-thumbs-swiper").EdumallSwiper(),c=a.children(".edumall-main-swiper").EdumallSwiper({thumbs:{swiper:t}});"undefined"!=typeof isw&&void 0!==isw.Swatches&&isw.Swatches.init(),"undefined"!=typeof wc_add_to_cart_variation_params&&this.content.find(".variations_form").each(function(){u(this).wc_variation_form()});var s=this.content.find(".variations_form"),l=s.data("product_variations");s.find("select").on("change",function(){for(var t=!0,a={},e=s.serializeArray(),i=0;i<e.length;i++){var n=e[i].name;if("attribute_"===n.substring(0,10)&&(a[n]=e[i].value,""===e[i].value)){t=!1;break}}if(!0===t){a=JSON.stringify(a);for(i=l.length-1;0<=i;i--){var r,o=l[i].attributes;JSON.stringify(o)==a&&(r=l[i].image_id,c.$wrapperEl.find(".swiper-slide").each(function(t){var a=u(this).attr("data-image-id");if((a=parseInt(a))===r)return c.slideTo(t),!1}))}}else{var d=c.$wrapperEl.find(".product-main-image").index();c.slideTo(d)}})}}})}u(document).ready(function(){var i;u(".edumall-product").on("click",".quick-view-btn",function(t){t.preventDefault(),t.stopPropagation();var a=u(this);a.parents(".product-actions").first().addClass("refresh"),a.addClass("loading");var t=a.data("pid"),e=n.children("#popup-product-quick-view-content-"+t);0<e.length?r(e,a):(t={action:"product_quick_view",pid:t},u.ajax({url:$edumall.ajaxurl,type:"POST",data:u.param(t),dataType:"json",success:function(t){e=u(t.template),n.append(e),r(e,a)}}))}),i=[],n.on("click",".ajax_add_to_cart",function(){var t=u(this).parents(".cart-notification").first().data("notification"),a='<span class="added-text">'+$edumall.noticeAddedCartText+"</span>",e=a;void 0!==t&&(e='<div class="product-added-cart">',""!==t.image&&(e+='<div class="product-thumbnail"><img src="'+t.image+'" alt="'+t.title+'"/></div>'),e+='<div class="product-caption"><h3 class="product-title">'+t.title+" </h3>"+a+"</div>",e+="</div>"),e+='<div class="tm-button-wrapper btn-view-cart"><a href="'+$edumall.noticeCartUrl+'" class="tm-button button-grey style-flat tm-button-xs tm-button-full-wide">'+$edumall.noticeCartText+"</a></div>",i.push(e)}),n.on("added_to_cart",function(){for(var t=0;t<i.length;t++){var a=i[t];u.growl({location:"br",duration:5e3,title:"",message:a}),i.splice(t,1)}}),u(document).on("click",".single_add_to_cart_button:not(.disabled)",function(t){var e=u(this),i=e.closest("form.cart"),a=i.find('input:not([name="product_id"]), select, button, textarea').serializeArrayAll()||0;return u.each(a,function(t,a){"add-to-cart"==a.name&&(a.name="product_id",a.value=i.find("input[name=variation_id]").val()||e.val())}),t.preventDefault(),u(document.body).trigger("adding_to_cart",[e,a]),u.ajax({type:"POST",url:woocommerce_params.wc_ajax_url.toString().replace("%%endpoint%%","add_to_cart"),data:a,beforeSend:function(t){e.removeClass("added").addClass("loading updating-icon")},complete:function(t){e.addClass("added").removeClass("loading updating-icon")},success:function(t){t.error&t.product_url?window.location=t.product_url:u(document.body).trigger("added_to_cart",[t.fragments,t.cart_hash,e])}}),!1})})}(jQuery);